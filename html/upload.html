<html>
<head>
    <meta charset="utf-8">
</head>
<body>
    <form action="/upload" method="post" enctype="multipart/form-data">
        <input name="file" type="file">
        <input type="submit" value="submit" />
    </form>
    <img src="" style="width: 50vw" />
</body>
<script type="text/javascript">
  window.addEventListener('DOMContentLoaded', function () {
    document.querySelector('input[type=submit]').addEventListener('click', function (event) {
      console.log('onSubmit')
      event.preventDefault()
      var formData = new FormData(document.querySelector('form'))
      var xhr = new XMLHttpRequest()
      xhr.open('POST', '/upload')
      xhr.send(formData)
      xhr.onreadystatechange = function () {
          if (this.readyState === 4 && this.status === 200) {
              console.log('upload ok')
              document.querySelector('img').src = '/show' + '?v=' + Date.now()
          }
      }
    })
  })
</script>
</html>